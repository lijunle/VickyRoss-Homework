# 表单处理

从这个任务开始，前端技术开始和后端技术打交道了。这一个任务会出现一些简单的PHP的代码，要求理解但并不要求掌握使用。

在正式开始这个任务之前，先回顾一下前面学到的3个网页技术，HTML，CSS和JavaScript。你需要**完全明白**，他们分别用来做什么的。

## 要求一

我们前面所有学到的网页技术，用户结果都只能显示在网页上。刷新了之后，数据就丢失了。

例如，在上一个计算器任务中，我们如果想保存用户最后的计算结果，就需要把结果存回后端，并保存到数据库或者文件中。而当用户再次打开网页的时候，就从数据库中读取上次的结果，放在HTML中发从给前端。也就是说，这里有2个步骤，保存和读取。

### 保存数据

保存数据，可以有2个方法，传统的方法叫做**表单（form）**，新的方法叫做**AJAX**。AJAX是对于传统方法的提升，会在下一个任务中学习。这里先学习传统的方法，和理解它的限制。

传统方法的保存数据分为2个步骤，首先是HTML去**提交表单**，然后后端程序接受到HTML提交的表单了，就开始**处理表单**。

### 提交表单

提交表单使用的是HTML的`form`标签。

阅读关于`form`标签的教学：http://www.w3school.com.cn/html/html_forms.asp

### 处理表单

处理表单需要用到后端语言。在这里，我使用PHP，因为它的语法贴近HTML，容易理解。对于这些PHP代码，不要求掌握运用，但是需要理解。

阅读关于使用PHP处理表单的教学：http://www.w3school.com.cn/php/php_forms.asp

我写了一个简单的文件（[`post.php`](post.php)）来处理表单。为了简单起见，它把传过来的数据保存到文件里面，正式的做法应该是保存到数据库里面。

### 读取数据

这里有一个问题，当用户第二次访问的时候，需要把上一次保存的数据读取出来，然后写在HTML上面。这就需要我们**动态地**生成HTML文件。

我写了一个文件（[`index.php`](index.php)）来展示这个过程。整个文件跟普通的HTML文件没有多少区别，唯一的区别在于`input`的`value`值是通过PHP代码从文件读取出来的。

### Demo

我把上述2个文件，上传到服务器：http://vicky-php.azurewebsites.net/

你需要使用F12里面的**网络**工具，监控**提交表单**和**处理表单**是怎么工作的。这里需要深刻理解！

如果你想修改这2个PHP文件，请问我拿服务器的账户和密码。

### 安全

表单的出现，意味着用户输入，保存数据和再次展示。而作为一个网页开发人员，你需要保证时刻留意数据的安全。

在上面的demo页面，你尝试输入`"><script>alert('You are hacked!')</script><a data-v="`（包括前后的2个引号）并保存。刷新页面发生什么事情？

这是十分经典的[JavaScript注入攻击](http://www.oschina.net/news/29110/javascript-injection)。深刻理解攻击是怎么发生的！

你可以尝试使用 HTML Encode（PHP的[htmlspecialchars](http://php.net/manual/en/function.htmlspecialchars.php)方法） 解决这个问题。
